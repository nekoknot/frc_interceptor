[n.global]
output = duktape

[n.include]
duktape/

[duk_config.h]
preprocess = true
reset = true
search = """__attribute__ ((visibility("default"))) extern"""
replace = ""


[duktape.h]
preprocess = true
reset = true
defines = true
compile = duktape.c
rename = "duktape_sys.nim"

search.structs = """
struct duk_thread_state;
struct duk_memory_functions;
struct duk_function_list_entry;
struct duk_number_list_entry;
struct duk_time_components;
"""
replace.structs = ""


[duktape_sys.nim]
search.0 = "duk_bool_t"
replace.0 = "cuint"

search.1 = "duk_int_t"
replace.1 = "cint"

search.2 =  "duk_uint_t"
replace.2 = "cuint"

search.3 = "duk_int32_t"
replace.3 = "int32"

search.4 = "duk_uint32_t"
replace.4 = "uint32"

search.5 = "duk_int16_t"
replace.5 = "int16"

search.6 = "duk_uint16_t"
replace.6 = "uint16"

search.7 = "duk_small_uint_t"
replace.7 = "cuint"

search.8 = "duk_double_t"
replace.8 = "cdouble"

search.9 = "duk_ret_t"
replace.9 = "cint"

search.10 = "duk_size_t"
replace.10 = "cuint"

search.ctx = "ptr duk_context"
replace.ctx = "duk_context"


prepend = """
type
  duk_context* = pointer

  duk_idx_t* = cint
  duk_codepoint_t* = cint
  duk_errcode_t* = cint
  duk_uarridx_t* = cuint

  va_list* {.importc: "va_list", header: "<stdarg.h>".} = object
"""

search.include_h = "/.h"
replace.include_h = "/duktape.h"
